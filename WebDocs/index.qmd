# Exercise 3 Report

### *Oliver E. Todreas* \| *2025-11-14*

## Introduction

## Statistical Analysis

## Results

![**Figure 1.** Figure description](images/Fig1.svg){fig-align="center"}

## Conclusions

## Code

The code below is a copy of the code in `Script/Analysis.R`. You may run the aforementioned file.

```{r}
# # Install libraries
# install.packages("here")
# install.packages("tidyverse")
# install.packages("svglite")

# Import libraries
library(here)
library(tidyverse)
library(svglite)

# Import data
df <- read.csv(here("Data", "butterflies.csv"))

# Convert to tibble
data <- as_tibble(df)

# Select relevant data
data <- data %>% select(LarvalHost, MaternalHost, AdultWeight, GrowthRate)

# Fit linear models and perform ANOVA
m_aw <- lm(data$AdultWeight ~ data$LarvalHost * data$MaternalHost - 1)
m_gr <- lm(data$GrowthRate ~ data$LarvalHost * data$MaternalHost - 1)
anova_aw <- anova(m_aw)
anova_gr <- anova(m_gr)

# Save ANOVA output to csv
write.csv(anova_aw, here("Output", "anova_aw.csv"))
write.csv(anova_gr, here("Output", "anova_gr.csv"))

# Pivot data along responses to help with plotting facets
data_p <- data %>%
  pivot_longer(
    cols = AdultWeight:GrowthRate, names_to = "Response", values_to = "Value"
  )

# Create custom labels for the plot facets
response.labs <- c("Adult Weight (mg)", "Growth Rate (mg/day)")
names(response.labs) <- c("AdultWeight", "GrowthRate")

# Plot and save
data_p %>%
  ggplot(aes(
    x = factor(LarvalHost, level = c("Berteroa", "Barbarea")), y = Value,
    fill = MaternalHost
  )) +
  geom_boxplot() +
  labs(x = "Larval Host", y= NULL, fill = "Maternal Host") +
  facet_wrap(
    facets = vars(Response), nrow = 2,
    strip.position = "left",  # Move facet labels left to act as y-axis labels
    scales = "free_y", labeller = labeller(Response = response.labs)
  ) +
  theme(
    strip.background = element_blank(),  # Clear background behind facet labels
    strip.placement='outside'  # Place labels outside of axis ticks
  )
ggsave(here("Output", "Fig1.svg"), width = 1100, height = 1100, units = "px")
```